<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Jhierz Trading Journal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>

.glow-green {
  color: #78e110;
  font-weight: bold;
  text-shadow:
    0 0 2px #7CFC00,
    0 0 4px #7ff904,
    0 0 6px #3aff3a,
    0 0 8px #3aff3a;
}
.yellow-text {
  color: #ffff33; /* bright readable yellow */
  font-weight: bold;
}




    :root {
      --bg: #0e1a24;
      --card: #132a3c;
      --text: #d9f0ff;
      --green: #65f2b0;
      --red: #f27777;
      --border: #3b627e;
      --blue: #88ccf1;
      --accent: #b8e3ff;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(to right, #1b3a4b, #275b75);
      padding: 1rem;
      font-size: 1.2rem;
      color: var(--accent);
      text-shadow: 0 0 5px var(--accent);
    }

    header .center-title {
      font-size: 1.8rem;
      font-weight: bold;
      text-align: center;
      flex-grow: 1;
    }

    .container {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    .sidebar {
      width: 250px;
      background: var(--card);
      padding: 1rem;
      overflow-y: auto;
      border-right: 1px solid var(--border);
    }

    .main {
      flex: 1;
      padding: 1rem;
      overflow-y: auto;
    }

    select, input, button {
      background: var(--bg);
      color: var(--text);
      border: 1px solid var(--border);
      padding: 0.5rem;
      margin-bottom: 0.5rem;
      width: 100%;
      border-radius: 4px;
    }

    button {
      cursor: pointer;
      background-color: #1f3e52;
      transition: background 0.3s;
    }

    button:hover {
      background-color: #275b75;
    }

    .calendar {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 2px; /* was 4px */
}


    .day {
  background: radial-gradient(circle at center, #1f3e52, #132a3c 80%);
  padding: 4px; /* was 8px */
  border: 3px solid var(--border);
  border-radius: 8px;
  cursor: pointer;
  position: relative;
  min-height: 60px; /* was 80px */
  box-shadow:
    inset 0 0 3px rgba(184, 227, 255, 0.3),
    0 0 6px rgba(136, 204, 241, 0.3);
  font-size: 0.75rem; /* slightly smaller text */
  transition: transform 0.2s ease, box-shadow 0.3s ease;
}


    .day.positive {
  background: linear-gradient(to bottom right, rgba(101, 242, 176, 0.2), rgba(0, 255, 128, 0.1));
  border: 4px solid var(--green);
  box-shadow:
    0 0 12px var(--green),
    0 0 16px var(--green),
    0 0 20px var(--green),
    inset 0 0 10px rgba(101, 242, 176, 0.6);
}


    .day.negative {
      background: linear-gradient(to bottom right, rgba(242, 119, 119, 0.2), rgba(255, 0, 64, 0.1));
      border: 3px double var(--red);
      box-shadow:
        0 0 8px var(--red),
        inset 0 0 8px rgba(242, 119, 119, 0.5),
        0 0 12px rgba(242, 119, 119, 0.3);
    }

    .day-header {
  text-align: center;
  font-weight: bold;
  padding: 2px; /* was 4px */
  background: var(--border);
  border-radius: 4px;
  font-size: 0.75rem;
}

    .week-summary {
      margin-top: 1rem;
      background: var(--card);
      padding: 1rem;
      border-radius: 6px;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 10;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: var(--card);
      padding: 2rem;
      border-radius: 8px;
      width: 300px;
    }

.entry-symbol {
  font-weight: bold;
  font-size: 0.8rem;
}

.entry-pnl {
  font-size: 0.85rem;
  font-weight: bold;
  color: #e6c76f;
  text-shadow: 0 0 1px #e6c76f66;
  margin-top: 1px;
}



    .entry-link {
      display: inline-block;
      margin-top: 4px;
      color: var(--blue);
      text-decoration: underline;
    }

    .entry {
      font-size: 0.85rem;
    }

    .overview {
      margin-top: 1rem;
      padding: 1rem;
      background: var(--card);
      border-radius: 6px;
    }

    .positive { color: var(--green); }
    .negative { color: var(--red); }

    @media (max-width: 768px) {
      .container {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid var(--border);
      }

      header {
        flex-direction: column;
        text-align: center;
        gap: 0.5rem;
      }
    }
  </style>
</head>
<body>

 <header>
  <div>üí∞ Start: $<span id="headerStartingBalance" class="yellow-text">0.00</span></div>
  <div class="center-title">Jhierz Trading Journal</div>
  <div>üìä Balance: $<span id="headerCurrentBalance" class="yellow-text">0.00</span></div>
</header>



  <div class="container">
    <div class="sidebar">
      <label>Journal</label>
      <div id="journalList"></div>
      <input id="newJournalName" placeholder="New journal name" />
      <button onclick="addJournal()">Add Journal</button>
      <button onclick="deleteJournal()">Delete Current</button>

      <label>Year</label>
      <select id="yearSelect" onchange="renderCalendar()"></select>

      <label>Month</label>
      <select id="monthSelect" onchange="renderCalendar()">
        <option value="0">January</option>
        <option value="1">February</option>
        <option value="2">March</option>
        <option value="3">April</option>
        <option value="4">May</option>
        <option value="5">June</option>
        <option value="6">July</option>
        <option value="7">August</option>
        <option value="8">September</option>
        <option value="9">October</option>
        <option value="10">November</option>
        <option value="11">December</option>
      </select>

      <label>Starting Balance</label>
      <input id="startBalance" type="number" onchange="updateStartBalance()" />

      <div class="overview" id="overviewStats"></div>

      <button onclick="exportData()">üì§ Export</button>
      <input type="file" onchange="importData(event)" />
    </div>

    <div class="main">
      <div class="calendar" id="calendar"></div>
      <div class="week-summary" id="weeklySummary"></div>
    </div>
  </div>




  
  <div class="modal" id="entryModal">
    <div class="modal-content">
      <h3>Day Entry</h3>
      <input id="entrySymbol" placeholder="Symbol" />
      <input id="entryPnl" type="number" placeholder="PnL" />
      <input id="entryTrades" type="number" placeholder="Trade Count" />
      <input id="entryLink" placeholder="Link (optional)" />
      <button onclick="saveEntry()">Save</button>
    </div>
  </div>

  <script>
    const calendar = document.getElementById('calendar');
    const yearSelect = document.getElementById('yearSelect');
    const monthSelect = document.getElementById('monthSelect');
    const journalList = document.getElementById('journalList');
    const startBalanceInput = document.getElementById('startBalance');
    const overviewStats = document.getElementById('overviewStats');
    const weeklySummary = document.getElementById('weeklySummary');

    let data = JSON.parse(localStorage.getItem("tradingData")) || {};
    let currentJournal = Object.keys(data)[0] || "Main";
    let selectedDate = null;

    function saveData() {
      localStorage.setItem("tradingData", JSON.stringify(data));
    }

    function init() {
      const year = new Date().getFullYear();
      for (let y = year - 5; y <= year + 5; y++) {
        let opt = document.createElement("option");
        opt.value = y;
        opt.text = y;
        yearSelect.appendChild(opt);
      }
      yearSelect.value = year;
      monthSelect.value = new Date().getMonth();
      updateJournalList();
      renderCalendar();
    }

    function updateJournalList() {
      journalList.innerHTML = '';
      Object.keys(data).forEach(journal => {
        let btn = document.createElement("button");
        btn.textContent = journal;
        btn.onclick = () => {
          currentJournal = journal;
          startBalanceInput.value = data[currentJournal].start || 0;
          renderCalendar();
        };
        journalList.appendChild(btn);
      });
      if (!data[currentJournal]) {
        data[currentJournal] = { entries: {}, start: 0 };
        saveData();
      }
      startBalanceInput.value = data[currentJournal].start || 0;
    }

    function addJournal() {
      const name = document.getElementById("newJournalName").value.trim();
      if (name && !data[name]) {
        data[name] = { entries: {}, start: 0 };
        currentJournal = name;
        saveData();
        updateJournalList();
        renderCalendar();
      }
    }

    function deleteJournal() {
      if (confirm(`Delete journal '${currentJournal}'?`)) {
        delete data[currentJournal];
        currentJournal = Object.keys(data)[0] || "Main";
        saveData();
        updateJournalList();
        renderCalendar();
      }
    }

    function updateStartBalance() {
      data[currentJournal].start = parseFloat(startBalanceInput.value) || 0;
      saveData();
      renderCalendar();
    }

    function renderCalendar() {
      calendar.innerHTML = '';
      weeklySummary.innerHTML = '';
      const year = parseInt(yearSelect.value);
      const month = parseInt(monthSelect.value);
      const startDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const entries = data[currentJournal].entries || {};
      const startBal = parseFloat(data[currentJournal].start || 0);

      const weekdays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
      weekdays.forEach(day => {
        const div = document.createElement("div");
        div.className = "day-header";
        div.textContent = day;
        calendar.appendChild(div);
      });

      for (let i = 0; i < startDay; i++) {
        calendar.appendChild(document.createElement("div"));
      }

      for (let d = 1; d <= daysInMonth; d++) {
        const dateKey = `${year}-${String(month + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
        const entry = entries[dateKey] || {};
        const pnl = parseFloat(entry.pnl || 0);
        const div = document.createElement("div");
        div.className = "day";
        if (entry.pnl > 0) div.classList.add("positive");
        else if (entry.pnl < 0) div.classList.add("negative");

        div.innerHTML = `<strong>${d}</strong>`;
if (entry.symbol) {
  div.innerHTML += `<div class="entry-symbol">${entry.symbol}</div>`;
  div.innerHTML += `<div class="entry-pnl">$${pnl.toFixed(2)}</div>`;
}
        if (entry.link && entry.link.startsWith("http")) {
          div.innerHTML += `<a class="entry-link" href="${entry.link}" target="_blank">üîó</a>`;
        }

        if (!isNaN(startBal)) {
          const percent = ((pnl / startBal) * 100).toFixed(2);
          if (pnl !== 0) {
            div.innerHTML += `<div class="${pnl > 0 ? 'positive' : 'negative'}">${percent}%</div>`;
          }
        }

        div.onclick = () => {
          selectedDate = dateKey;
          document.getElementById("entrySymbol").value = entry.symbol || "";
          document.getElementById("entryPnl").value = entry.pnl || "";
          document.getElementById("entryTrades").value = entry.trades || "";
          document.getElementById("entryLink").value = entry.link || "";
          document.getElementById("entryModal").style.display = "flex";
        };

        calendar.appendChild(div);
      }

      renderOverview();
    }

    function saveEntry() {
      const symbol = document.getElementById("entrySymbol").value;
      const pnl = parseFloat(document.getElementById("entryPnl").value || 0);
      const trades = parseInt(document.getElementById("entryTrades").value || 0);
      const link = document.getElementById("entryLink").value;
      data[currentJournal].entries[selectedDate] = { symbol, pnl, trades, link };
      saveData();
      document.getElementById("entryModal").style.display = "none";
      renderCalendar();
    }

    window.onclick = (e) => {
      if (e.target.id === "entryModal") {
        document.getElementById("entryModal").style.display = "none";
      }
    };

    function updateHeaderBalances(startingBalance, currentBalance) {
      document.getElementById("headerStartingBalance").textContent = startingBalance.toFixed(2);
      document.getElementById("headerCurrentBalance").textContent = currentBalance.toFixed(2);
    }

    function renderOverview() {
      const entries = Object.values(data[currentJournal].entries || {});
      let totalTrades = 0, wins = 0, loss = 0, best = -Infinity, worst = Infinity, balance = data[currentJournal].start || 0;
      entries.forEach(e => {
        const pnl = parseFloat(e.pnl || 0);
        if (!isNaN(pnl)) {
          balance += pnl;
          if (pnl > 0) wins++;
          if (pnl < 0) loss++;
          best = Math.max(best, pnl);
          worst = Math.min(worst, pnl);
          totalTrades += parseInt(e.trades || 0);
          function renderWeeklySummary() {
  weeklySummary.innerHTML = '';
  const entries = data[currentJournal].entries || {};
  const year = parseInt(yearSelect.value);
  const month = parseInt(monthSelect.value);
  const startBal = parseFloat(data[currentJournal].start || 0);
  if (isNaN(startBal)) return;

  let weeklyPnL = 0;
  let weekNumber = 1;
  let weekStartDate = null;
  const daysInMonth = new Date(year, month + 1, 0).getDate();

  for (let d = 1; d <= daysInMonth; d++) {
    const date = new Date(year, month, d);
    const dayOfWeek = date.getDay();
    const dateKey = `${year}-${String(month + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
    const entry = entries[dateKey];
    const pnl = parseFloat(entry?.pnl || 0);

    if (dayOfWeek === 0 && weekStartDate !== null) {
      // End of the week (Sunday), push summary
      const percent = startBal > 0 ? ((weeklyPnL / startBal) * 100).toFixed(2) : '0.00';
      const colorClass = weeklyPnL > 0 ? 'positive' : (weeklyPnL < 0 ? 'negative' : '');
      weeklySummary.innerHTML += `
        <div>
          <b>Week ${weekNumber}:</b>
          <span class="${colorClass}">$${weeklyPnL.toFixed(2)} (${percent}%)</span>
        </div>
      `;
      weekNumber++;
      weeklyPnL = 0;
    }

    if (weekStartDate === null) {
      weekStartDate = date;
    }

    if (!isNaN(pnl)) {
      weeklyPnL += pnl;
    }

    // Handle final week if it's the end of the month
    if (d === daysInMonth) {
      const percent = startBal > 0 ? ((weeklyPnL / startBal) * 100).toFixed(2) : '0.00';
      const colorClass = weeklyPnL > 0 ? 'positive' : (weeklyPnL < 0 ? 'negative' : '');
      weeklySummary.innerHTML += `
        <div>
          <b>Week ${weekNumber}:</b>
          <span class="${colorClass}">$${weeklyPnL.toFixed(2)} (${percent}%)</span>
        </div>
      `;
    }
  }
}
renderWeeklySummary();

        }
      });
     const winRate = wins + loss > 0 ? ((wins / (wins + loss)) * 100).toFixed(2) + '%' : '0%';
  const balanceClass = balance >= data[currentJournal].start ? 'positive' : 'negative';
  const bestClass = best >= 0 ? 'positive' : 'negative';
  const worstClass = worst < 0 ? 'negative' : 'positive';

  overviewStats.innerHTML = `
    <div>üìä <b>Balance:</b> <span class="value ${balanceClass}">$${balance.toFixed(2)}</span></div>
    <div>üìà <b>Total Trades:</b> <span class="value">${totalTrades}</span></div>
    <div>‚úÖ <b>Win Rate:</b> <span class="value">${winRate}</span></div>
    <div>üèÜ <b>Best Day:</b> <span class="value ${bestClass}">${best === -Infinity ? '-' : best}</span></div>
    <div>üíî <b>Worst Day:</b> <span class="value ${worstClass}">${worst === Infinity ? '-' : worst}</span></div>
      `;
      updateHeaderBalances(data[currentJournal].start || 0, balance);
    }

    function exportData() {
      const blob = new Blob([JSON.stringify(data)], { type: "application/json" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "trading_journal.json";
      a.click();
    }

    function importData(event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        try {
          data = JSON.parse(e.target.result);
          currentJournal = Object.keys(data)[0];
          saveData();
          updateJournalList();
          renderCalendar();
        } catch (err) {
          alert("Invalid JSON file");
        }
      };
      reader.readAsText(file);
    }

    
    init();
  </script>
</body>
</html>
